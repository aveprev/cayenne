<html>
  <head>
    <title>Cayenne Documentation - Stored Procedures and Transactions</title>
    <style type="text/css">@import "../../../../style.css";</style>
  </head>
<body>
  <div class="header">
    <div style="float: left;"><a href="http://objectstyle.org/cayenne/"><img src="../../../../images/logo.gif" align="absmiddle" border="0"></a></div>
    <span class="logoSpaceLink"><a href="../../../../index.html">Cayenne User Documentation</a></span><br />
    <span class="pagetitle">Stored Procedures and Transactions</span>
  </div>
<div id="cayenne_toc">
<ul>
<li><a href="../../../../Documentation/User Guide/Introduction/index.html">Introduction</a></li>
<li><a href="../../../../Documentation/User Guide/Installation/index.html">Installation</a></li>
<li><a href="../../../../Documentation/User Guide/Quick Start/index.html">Quick Start</a></li>
<li><a href="../../../../Documentation/User Guide/Design/index.html">Design</a></li>
<li><a href="../../../../Documentation/User Guide/Generating Classes/index.html">Generating Classes</a></li>
<li><a href="../../../../Documentation/User Guide/DataContext/index.html">DataContext</a></li>
<li><a href="../../../../Documentation/User Guide/Queries/index.html">Queries</a></li>
<li><a href="../../../../Documentation/User Guide/DataObjects/index.html">DataObjects</a></li>
<li><a href="../../../../Documentation/User Guide/Stored Procedures/index.html">Stored Procedures</a><ul>
<li><a href="../../../../Documentation/User Guide/Stored Procedures/Executing a Stored Procedure/index.html">Executing a Stored Procedure</a></li>
<li><a href="../../../../Documentation/User Guide/Stored Procedures/Selecting Objects/index.html">Selecting Objects</a></li>
<li><a href="../../../../Documentation/User Guide/Stored Procedures/Stored Procedures and Transactions/index.html">Stored Procedures and Transactions</a><ul>
</ul>
</li>
</ul>
</li>
<li><a href="../../../../Documentation/User Guide/Expressions/index.html">Expressions</a></li>
<li><a href="../../../../Documentation/User Guide/Performance Tuning/index.html">Performance Tuning</a></li>
<li><a href="../../../../Documentation/User Guide/Deployment/index.html">Deployment</a></li>
<li><a href="../../../../Documentation/User Guide/Ant Tasks/index.html">Ant Tasks</a></li>
<li><a href="../../../../Documentation/User Guide/Access Stack Internals/index.html">Access Stack Internals</a></li>
<li><a href="../../../../Documentation/User Guide/DataViews/index.html">DataViews</a></li>
</ul>
</div>
<div id="ConfluenceContent"><p>There maybe a situations when stored procedures handle their own transactions and an application is configured to use Cayenne-managed transactions. This is obviously conflicting and undesirable behavior. In this case ProcedureQueries should be executed explicitly wrapped in an "external" Transaction. This is one of the few cases when a user should worry about transactions at all.</p>
<div class="code"><div class="codeContent">
<pre class="code-java">DataContext ctxt = ...;
ProcedureQuery query = ...;
QueryResult resultsCollection = <span class="code-keyword">new</span> QueryResult();

<span class="code-comment">// obtain a <span class="code-keyword">new</span> instance of <span class="code-quote">"external"</span> Transaction
</span>Transaction externalTransaction = Transaction.externalTransaction(<span class="code-keyword">null</span>);

<span class="code-comment">// run wrapping in Transaction that would not commit explicitly
</span>Transaction.performQueries(ctxt, Collections.singletonList(query), resultsCollection);

<span class="code-comment">// process results
</span>List results = resultCollection.getFirstRows(query);
...</pre>
</div></div></div>
</div>
  <div class="clearer">.</div>
  <div style="height: 12px; background-image: url('../../../../images/border_bottom.gif'); background-repeat: repeat-x;"></div>

  <div class="smalltext copyright">
    Copyright &copy;2001-2006 ObjectStyle Group and content authors
  </div>

</body>
</html>
